cmake_minimum_required(VERSION 2.8)

project(Professor)

MESSAGE("SDK is ${SDK}")
MESSAGE("CFG is ${CFG}")

if(NOT DEFINED PROFESSOR_SOURCE_DIR)
        SET(PROFESSOR_SOURCE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/)
endif(NOT DEFINED PROFESSOR_SOURCE_DIR)

SET(CMAKE_INSTALL_PREFIX output/${CFG}/${CORE_TARGET}/bin)
if(NOT DEFINED OUTPUT_BIN_DIR)
        SET(OUTPUT_BIN_DIR bin)
endif(NOT DEFINED OUTPUT_BIN_DIR)

if(NOT DEFINED OUTPUT_LIB_DIR)
        SET(OUTPUT_LIB_DIR lib)
endif(NOT DEFINED OUTPUT_LIB_DIR)

# ST SDK stuff
SET(SOUNDTOUCH_SDK_DIR ${PROFESSOR_SOURCE_DIR}/builds/SoundTouch-SDK-${SDK})

INCLUDE_DIRECTORIES(
    ${SOUNDTOUCH_SDK_DIR}/prebuilt/include
)

INCLUDE( ${SDK}.cmake )

SET(SOUNDTOUCH_SDK_LIB_DIR ${SOUNDTOUCH_SDK_DIR}/prebuilt/Libs)
SET(SOUNDTOUCH_SDK_LIBS
    ${SOUNDTOUCH_SDK_LIB_DIR}/libSoundTouchClient.a
    ${SOUNDTOUCH_SDK_LIB_DIR}/libSTS.a
    ${SOUNDTOUCH_SDK_LIB_DIR}/libShelbyUtils.a
    ${PROTOBUF_LIB}
)

# Platform independent compiler flags for Release/Debug
SET(CMAKE_SHARED_LIBRARY_LINK_C_FLAGS "")

IF( ${CFG} STREQUAL "Release" )
  SET(CMAKE_CXX_FLAGS "-Os -g2 -DNDEBUG ${COMMON_CXX_FLAGS} ${DISABLE_UNUSED_WARNING_FLAGS} ${PLATFORM_COMPILER_FLAGS}" CACHE STRING
  "Flags used by the C++ compiler during Release builds."
  FORCE )
  SET(CMAKE_C_FLAGS "-Os -g2 ${COMMON_C_FLAGS} ${DISABLE_UNUSED_WARNING_FLAGS} ${PLATFORM_COMPILER_FLAGS}" CACHE STRING
  "Flags used by the C compiler during Debug builds."
  FORCE )
  SET( CMAKE_EXE_LINKER_FLAGS " " CACHE STRING
  "Flags used for linking binaries during Release builds."
  FORCE )
ENDIF ( ${CFG} STREQUAL "Release" )

IF( ${CFG} STREQUAL "Debug" )
  SET(CMAKE_CXX_FLAGS "-g3 -fno-inline ${COMMON_CXX_FLAGS} ${DISABLE_UNUSED_WARNING_FLAGS} ${PLATFORM_COMPILER_FLAGS}" CACHE STRING
  "Flags used by the C++ compiler during Debug builds."
  FORCE )
  SET(CMAKE_C_FLAGS "-g3 ${COMMON_C_FLAGS} ${DISABLE_UNUSED_WARNING_FLAGS} ${PLATFORM_COMPILER_FLAGS}" CACHE STRING
  "Flags used by the C compiler during Debug builds."
  FORCE )
  SET( CMAKE_EXE_LINKER_FLAGS " " CACHE STRING
  "Flags used for linking binaries during Debug builds."
  FORCE )
  ADD_DEFINITIONS("-DDISABLE_WD_PANIC")
ENDIF ( ${CFG} STREQUAL "Debug" )

  MESSAGE(C flags are ${CMAKE_C_FLAGS})

#SET(BUILD_CFG_DIR ${PROFESSOR_SOURCE_DIR}/BuildConfig)
INCLUDE( exe.cmake )
INCLUDE( package.cmake )

MESSAGE("SOUNDTOUCH_SDK_DIR is ${SOUNDTOUCH_SDK_DIR}")
