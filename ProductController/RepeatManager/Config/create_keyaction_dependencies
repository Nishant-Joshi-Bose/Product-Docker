#!/usr/bin/python2.7
# -*- python -*-
# This script will generate RepeatManagerKeyAction.proto and RepeatManagerKeyAction.h files
# RepeatManagerKeyAction.proto file contains all the enums which are related to EventAction field in KeyConfiguration.json
# RepeatManagerKeyAction.h file contains the map variable based ont he string and the enum values for the EventAction field
#

import os, sys, imp, json, io

protofilename = "../PB/RepeatManagerKeyAction.proto"

protostring = '/**************************************************************************\r\n'
protostring += '* ABSOLUTELY UNDER NO CONDITION SHOULD YOU INCLUDE THIS FILE DIRECTLY\r\n'
protostring += '* INSTEAD; YOU SHOULD INCLUDE RepeatManagerKeyAction.pb.h\r\n*\r\n'
protostring += '* This file is auto generated, DO NOT EDIT!\r\n'
protostring += '**************************************************************************/\r\n\r\n'
protostring += 'enum KEY_EVENT_ACTION\r\n{\r\n    INVALID_BUTTON_EVENT_ACTION = -1;'

index = 0

with open('KeyConfiguration.json') as data_file:
    data = json.load(data_file)

for item in data["keyTable"]:
    protostring += '\r\n    ' + item["EventAction"] + ' = ' + str(index) + ';'
    index += 1

protostring += '\r\n}\r\n'

# Creating proto file with enum values after reading from json config file
with io.FileIO(protofilename, "w") as file:
    file.write(protostring)
